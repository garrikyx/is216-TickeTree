<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Marketplace</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        crossorigin="anonymous" />

    <!-- Vue.js CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <style>
        /* Custom styles for marketplace cards */
        .card {
            height: 100%;
        }

        .marketplace-section {
            margin-top: 20px;
        }

        .event-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .card-columns {
            column-gap: 30px;
        }

        .dropdown-menu {
            max-height: 300px;
            overflow-y: auto;
        }

        .row {
            margin-bottom: 20px; /* Adds space between rows */
        }
    </style>
</head>

<body>
    <div id="app">
        <!-- Navbar -->
        <navbar></navbar>

        <!-- Marketplace Section -->
        <div class="container marketplace-section">
            <marketplace></marketplace>
        </div>
    </div>

    <!-- JavaScript & Vue Components -->
    <script>
        // Navbar component
        const Navbar = {
        template: `
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-0">
          <div class="container-fluid">
            <a class="navbar-brand text-warning" href="/">
              <span class="me-1">üéüÔ∏è</span>
              LOGO/NAME
            </a>
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNav"
              aria-controls="navbarNav"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav mx-auto mb-2 mb-lg-0 ">
                <li v-for="item in navItems" :key="item.path" class="nav-item">
                  <a
                    :href="item.path"
                    class="nav-link"
                  >
                    {{ item.label }}
                  </a>
                </li>
                // sign in logic here
                <li class="nav-item nav-link text-light d-lg-none ">
                  Login
                </li>
              </ul>
              </div>
              <a href="/login" class="btn btn-primary d-none d-lg-block me-4"> 
              Login
            </a>
          </div>
        </nav>
        `,
        data() {
          return {
            navItems: [
              { path: "/", label: "Home" },
              { path: "/marketplace", label: "Marketplace" },
              { path: "/myevents", label: "My Events" },
            ],
          };
        },
        methods: {},
      };

        // Marketplace component
        const Marketplace = {
            template: `
            <div class="container mt-4">
                <!-- Filter dropdown -->
                <div class="d-flex justify-content-start align-items-center mb-3">
                <div class="dropdown">
                    <button
                    class="btn btn-secondary dropdown-toggle"
                    type="button"
                    id="filterDropdown"
                    data-bs-toggle="dropdown"
                    aria-expanded="false"
                    >
                    Filter By
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="filterDropdown">
                    <li>
                        <a class="dropdown-item" @click="setCategory('Entertainment')">Entertainment</a>
                    </li>
                    <li>
                        <a class="dropdown-item" @click="setCategory('Sports')">Sports</a>
                    </li>
                    <li>
                        <a class="dropdown-item" @click="setCategory('Arts & Culture')">Arts & Culture</a>
                    </li>
                    <li>
                        <a class="dropdown-item" @click="setCategory('Conferences & Conventions')">Conferences & Conventions</a>
                    </li>
                    <li>
                        <a class="dropdown-item" @click="setCategory('Travel & Adventure')">Travel & Adventure</a>
                    </li>
                    <li>
                        <a class="dropdown-item" @click="setPrice('low')">Price: Low to High</a>
                    </li>
                    <li>
                        <a class="dropdown-item" @click="setPrice('high')">Price: High to Low</a>
                    </li>
                    <li>
                        <a class="dropdown-item" @click="setDate('ascending')">Date: Earliest First</a>
                    </li>
                    <li>
                        <a class="dropdown-item" @click="setDate('descending')">Date: Latest First</a>
                    </li>
                    </ul>
                </div>

                <!-- Selected filters will be displayed here as badges -->
                <div class="ms-3">
                    <span
                    v-for="filter in selectedFilters"
                    :key="filter"
                    class="badge bg-info me-2"
                    >
                    {{ filter }}
                    <button type="button" class="btn-close btn-close-white ms-2" aria-label="Remove" @click="removeFilter(filter)"></button>
                    </span>
                </div>
            </div>
                <div class="row">
                    <div class="col-md-4" v-for="ticket in filteredTickets" :key="ticket.id">
                        <div class="card mb-3">
                            <!-- Event Image -->
                            <img :src="ticket.image" class="card-img-top event-image" :alt="ticket.eventName">

                            <!-- Event Details -->
                            <div class="card-body">
                                <h5 class="card-title">{{ ticket.eventName }}</h5>
                                <p class="card-text">Category: {{ ticket.category }}</p>
                                <p class="card-text">Date: {{ ticket.date }}</p>
                                <p class="card-text">Time: {{ ticket.time }}</p>
                                <p class="card-text">Location: {{ ticket.location }}</p>
                                <p class="card-text" v-if="ticket.seatCategory">Seat Category: {{ ticket.seatCategory }}</p>
                                <p class="card-text" v-if="ticket.section">Section: {{ ticket.section }}</p>
                                <p class="card-text" v-if="ticket.seatNumber">Seat Number: {{ ticket.seatNumber }}</p>
                                <p class="card-text text-success">Price: {{ ticket.price }}</p>
                                <button class="btn btn-primary">Buy Ticket</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            `,
            
            data() {
                return {
                tickets: [
                    // Your event objects with id, title, image, category, date, time, seat info, price, etc.
                    {
                            id: 1,
                            eventName: "Concert A",
                            location: "Singapore Indoor Stadium",
                            category: "Entertainment",
                            seatCategory: "VIP",
                            section: "A1",
                            seatNumber: 15,
                            price: 120,
                            date: "2024-12-01",
                            time: "7:00 PM",
                            image: "https://example.com/concert.jpg"
                        },
                        {
                            id: 2,
                            eventName: "Sports Event B",
                            location: "National Stadium",
                            category: "Sports",
                            seatCategory: "General",
                            section: "B2",
                            seatNumber: 42,
                            price: 180,
                            date: "2024-11-15",
                            time: "5:00 PM",
                            image: "https://example.com/sportsevent.jpg"
                        },
                        {
                            id: 3,
                            eventName: "Art Festival C",
                            location: "Marina Bay Sands",
                            category: "Arts & Culture",
                            seatCategory: null,
                            section: null,
                            seatNumber: null,
                            price: 80,
                            date: "2024-10-22",
                            time: "6:00 PM",
                            image: "https://example.com/artfestival.jpg"
                        },
                        {
                            id: 4,
                            eventName: "Tech Conference D",
                            location: "SMU",
                            category: "Conferences and Conventions",
                            seatCategory: "VIP",
                            section: "D1",
                            seatNumber: 5,
                            price: 270,
                            date: "2024-12-05",
                            time: "9:00 AM",
                            image: "https://example.com/techconference.jpg"
                        },
                        {
                            id: 5,
                            eventName: "Adventure Trip E",
                            location: "Tioman Island",
                            category: "Travel and Adventure",
                            seatCategory: null,
                            section: null,
                            seatNumber: null,
                            price: 230,
                            date: "2024-11-02",
                            time: "All Day",
                            image: "https://example.com/adventuretrip.jpg"
                        }
                ],
                selectedFilters: [], // Store selected filters
                filteredTickets: [], // Tickets after applying filters
                };
            },
            methods: {
                // Set filter by category
                setCategory(category) {
                    if (!this.selectedFilters.includes(category)) {
                    this.selectedFilters.push(category);
                    }
                    this.filterTickets();
                },
                // Set filter by price
                setPrice(order) {
                    const label = order === 'low' ? 'Price: Low to High' : 'Price: High to Low';
                    if (!this.selectedFilters.includes(label)) {
                    this.selectedFilters.push(label);
                    }
                    this.filterTickets();
                },
                // Set filter by date
                setDate(order) {
                    const label = order === 'ascending' ? 'Date: Earliest First' : 'Date: Latest First';
                    if (!this.selectedFilters.includes(label)) {
                    this.selectedFilters.push(label);
                    }
                    this.filterTickets();
                },
                
                // Filtering logic
                filterTickets() {
                    let filtered = [...this.tickets]; // Create a copy of the tickets array

                    // Filter by category
                    const categoryFilters = ['Entertainment', 'Sports', 'Arts & Culture', 'Conferences & Conventions', 'Travel & Adventure'];
                    const selectedCategory = this.selectedFilters.find(filter => categoryFilters.includes(filter));
                    if (selectedCategory) {
                    filtered = filtered.filter(ticket => ticket.category === selectedCategory);
                    }

                    // Filter by price
                    if (this.selectedFilters.includes('Price: Low to High')) {
                    filtered.sort((a, b) => a.price - b.price); // Sort low to high
                    } else if (this.selectedFilters.includes('Price: High to Low')) {
                    filtered.sort((a, b) => b.price - a.price); // Sort high to low
                    }

                    // Filter by date
                    if (this.selectedFilters.includes('Date: Earliest First')) {
                    filtered.sort((a, b) => new Date(a.date) - new Date(b.date)); // Sort earliest first
                    } else if (this.selectedFilters.includes('Date: Latest First')) {
                    filtered.sort((a, b) => new Date(b.date) - new Date(a.date)); // Sort latest first
                    }

                    // Update filtered tickets
                    this.filteredTickets = filtered;
                },
                
                // Remove a selected filter
                removeFilter(filter) {
                    const index = this.selectedFilters.indexOf(filter);
                    if (index > -1) {
                    this.selectedFilters.splice(index, 1); // Remove the filter
                    }
                    this.filterTickets(); // Re-filter tickets after removing a filter
                }
                },

            mounted() {
                this.filteredTickets = this.tickets; // Initially show all tickets
            },
            };
            
        // Vue App Initialization
        const app = Vue.createApp({
            components: {
                navbar: Navbar,
                marketplace: Marketplace,
            },
        });

        app.mount('#app');
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>
</body>
</html>

